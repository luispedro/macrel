ngless "1.0"

input = samfile(ARGV[1],
             name="MACREL")

# Keep only primary alignments
filtered = select(input, keep_if=[{unique}])

# Count features from filtered alignments
counts = count(filtered,
    features=["seqname"],
    include_minus1=False,
    normalization={raw},
    multiple={unique_only})

write(counts, ofile=ARGV[2])
