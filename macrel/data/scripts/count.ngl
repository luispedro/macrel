ngless "1.0"

input = samfile(ARGV[1],
             name="MACREL")

filtered = select(input, keep_if=[{unique}])

counts = count(filtered,
    features=["seqname"],
    include_minus1=False,
    normalization={raw},
    multiple={unique_only})

counts = as_integer(round(counts))
write(counts, ofile=ARGV[2])
